{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}
Karte der Hilfsbereiten
{% endblock %}

{% block header %}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
 integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
 crossorigin=""/>
<link rel="stylesheet" href="{% static 'css/map.css' %}"> <!-- Make sure you put this AFTER Leaflet's CSS -->
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
   integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
   crossorigin=""></script>
{% endblock %}



{% block content %}
<!--<form action="/iamstudent/student_registration" method="get">
    <input type="submit" value="Register me"
         name="Register" id="frm1_submit" />
</form>-->
 <div id="mapid"></div>


 <script type="text/javascript">
   var mymap = L.map('mapid').setView([51.13, 10.018], 6);
   L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoiam9zYXVkZXIiLCJhIjoiY2s4MWNxa2QzMDNkejNrcDVhbzV6MDMxYSJ9.O4sLC7VSSgy4S7EKjNoG1g', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox/streets-v11',
    tileSize: 512,
    zoomOffset: -1,
    preferCanvas: true
  }).addTo(mymap);

 </script>
 {% for location in locations %}

 <script type="text/javascript">
   var circle = L.circle([ {{ location.lon }}, {{ location.lat }} ], {
       color: 'blue',
       weight: 2 + 0.5 * {{ location.count }},
       fillColor: 'blue',
       fillOpcity: 0.7,
       radius: 500 + 100 * {{ location.count }}
   })
   .bindPopup('In {{ location.ort }} (PLZ {{location.plz }}) gibt es {{ location.count }} Studierende die helfen möchten. <a href=/ineedstudent/students/{{ location.plz }}/0>Detailansicht</a>')
   .addTo(mymap);
 </script>
 {% endfor %}

 <nav class="navbar fixed-bottom navbar-expand-sm navbar-dark bg-dark">
   <div class="mx-auto order-0">
      <input type="text" id="search" class="form">
      <button class="btn btn-secondary" role="button" onclick="gototable()" >Suche nach Postleitzahl &raquo;</button>
    </div>
   </nav>
  <script type="text/javascript">
    var gototable = function() {
      window.location = "/ineedstudent/students/" + $('#search').val() + "/0"
    }
  </script>

{% endblock %}
